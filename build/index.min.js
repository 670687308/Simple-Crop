!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.simplecrop=e():t.SimpleCrop=e()}(window,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){var i,r,o;r=[n(1),n(2),n(3)],void 0===(o="function"==typeof(i=function(t,e,n){var i=function(){var t,e=document.createElement("div"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",MsTransition:"msTransitionEnd"};for(t in n)if(void 0!==e.style[t])return n[t]}(),r=t.prefix("transform"),o=t.prefix("transition");function s(t){this.id="crop-"+(new Date).getTime(),this.visible=null==t.visible||t.visible,this.title=null!=t.title?t.title:"",this.debug=null!=t.debug&&t.debug,this.$container=null!=t.$container?t.$container:document.body,this.scaleSlider=null!=t.scaleSlider&&t.scaleSlider,this.maxScale=t.maxScale?t.maxScale:1;var e=this;e.passiveSupported=!1;try{var n=Object.defineProperty({},"passive",{get:function(){e.passiveSupported=!0}});window.addEventListener("test",null,n)}catch(t){}this.isSupportTouch="ontouchend"in document,this._multiPoint=!1,this._rotateScale=1,this._baseMoveX=0,this._curMoveX=0,this._changedX=0,this._downPoints=[],this._isControl=!1,this._scaleMoveX=0,this._baseAngle=0,this.scaleTimes=1,this.rotateAngle=0,this.construct(),this.initFuncBtns(t),this.initRotateSlider(t),this.initChilds(),this.initBoxBorder(t,!0),this.updateBox(t),this.bindEvent()}return Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){var n=Object(this),i=n.length>>>0;if(0===i)return!1;for(var r,o,s=0|e,a=Math.max(s>=0?s:i-Math.abs(s),0);a<i;){if((r=n[a])===(o=t)||"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))return!0;a++}return!1}}),s.prototype.initTitle=function(t){this.title=null!=t.title?t.title:"",this.$title=document.querySelector("#"+this.id+" .crop-title"),this.$title.innerText=this.title,t.title?this.$title.style.visibility="hidden":this.$title.style.visibility=""},s.prototype.initBoxBorder=function(t,e){this.borderWidth=null!=t.borderWidth?t.borderWidth:1,this.borderColor=null!=t.borderColor?t.borderColor:"#fff",this.boldCornerLen=null!=t.boldCornerLen?t.boldCornerLen:24,this.coverColor=null!=t.coverColor?t.coverColor:"rgba(0,0,0,.3)",this.coverDraw=null!=t.coverDraw?t.coverDraw:function(){},this.borderDraw=null!=t.borderDraw?t.borderDraw:this.defaultBorderDraw,e||(this.borderDraw(this.$cropCover),this.coverDraw(this.$cropCover))},s.prototype.initFuncBtns=function(t){this.funcBtns=null!=t.funcBtns?t.funcBtns:["close","crop","around","reset"],this.cropCallback=null!=t.cropCallback?t.cropCallback:function(){},this.closeCallback=null!=t.closeCallback?t.closeCallback:function(){},this.uploadCallback=null!=t.uploadCallback?t.uploadCallback:function(){},this.$cropBtns=document.querySelector("#"+this.id+" .crop-btns");var e="";this.funcBtns.includes("upload")&&(e+='<div class="upload-btn-container">',e+='<button class="upload-btn"></button>',e+='<input type="file" accept="image/png,image/jpeg">',e+="</div>"),this.funcBtns.includes("close")&&(e+='<button class="crop-close"></button>'),this.funcBtns.includes("around")&&(e+='<button class="crop-around"></button>'),this.funcBtns.includes("reset")&&(e+='<button class="crop-reset"></button>'),this.funcBtns.includes("crop")&&(e+='<button class="crop-btn"></button>'),this.$cropBtns.innerHTML=e,this.funcBtns.includes("upload")&&(this.$uploadBtn?this.$uploadBtn.removeEventListener("change",this.__uploadInput):this.__uploadInput=this.uploadInput.bind(this),this.$uploadBtn=document.querySelector("#"+this.id+" .upload-btn-container"),this.$uploadInput=document.querySelector("#"+this.id+" .upload-btn-container input"),this.$uploadBtn.addEventListener("change",this.__uploadInput)),this.funcBtns.includes("crop")&&(this.$cropBtn?this.$cropBtn.removeEventListener("click",this.__crop):this.__crop=this.crop.bind(this),this.$cropBtn=document.querySelector("#"+this.id+" .crop-btn"),this.$cropBtn.addEventListener("click",this.__crop)),this.funcBtns.includes("around")&&(this.$aroundBtn?this.$aroundBtn.removeEventListener("click",this.__around):this.__around=this.around.bind(this),this.$aroundBtn=document.querySelector("#"+this.id+" .crop-around"),this.$aroundBtn.addEventListener("click",this.__around)),this.funcBtns.includes("reset")&&(this.$resetBtn?this.$resetBtn.removeEventListener("click",this.reset):this.__reset=this.reset.bind(this),this.$resetBtn=document.querySelector("#"+this.id+" .crop-reset"),this.$resetBtn.addEventListener("click",this.__reset)),this.funcBtns.includes("close")&&(this.$closeBtn?this.$closeBtn.removeEventListener("click",this.close):this.__close=this.close.bind(this),this.$closeBtn=document.querySelector("#"+this.id+" .crop-close"),this.$closeBtn.addEventListener("click",this.__close)),this.funcBtns.length>0?this.$cropBtns.style.visibility="":this.$cropBtns.style.visibility="hidden"},s.prototype.initRotateSlider=function(t){this.rotateSlider=null==t.rotateSlider||t.rotateSlider,this.startAngle=null!=t.startAngle?t.startAngle:-90,this.endAngle=null!=t.endAngle?t.endAngle:90,this.gapAngle=null!=t.gapAngle?t.gapAngle:10,this.lineationItemWidth=null!=t.lineationItemWidth?t.lineationItemWidth:40.5,this.lineationItemWidth=this.lineationItemWidth>=40.5?this.lineationItemWidth:40.5,this.startAngle=this.startAngle<0?parseInt(this.startAngle):0,this.endAngle=this.endAngle>0?parseInt(this.endAngle):0,this.gapAngle=this.gapAngle>0?parseInt(this.gapAngle):3,(this.endAngle-this.startAngle)%this.gapAngle!=0&&(this.endAngle=Math.ceil((this.endAngle-this.startAngle)/this.gapAngle)*this.gapAngle+this.startAngle),this.lineationWidth=this.lineationItemWidth*((this.endAngle-this.startAngle)/this.gapAngle+1),this.$cropRotate=document.querySelector("#"+this.id+" .crop-rotate"),this.$lineation=document.querySelector("#"+this.id+" .lineation"),this.$rotateCurrent=document.querySelector("#"+this.id+" .current");var e=window.getComputedStyle(this.$cropRotate);this.rotateWidth=parseFloat(e.getPropertyValue("width")),this._baseMoveX=-(this.lineationWidth*(0-this.startAngle+this.gapAngle/2)/(this.endAngle-this.startAngle+this.gapAngle)-this.rotateWidth/2);var n=this.rotateAngle-this._baseAngle;this._curMoveX=n*this.lineationWidth/(this.endAngle-this.startAngle+this.gapAngle)+this._baseMoveX,(this._curMoveX>0||this._curMoveX<this.rotateWidth-this.lineationWidth)&&(this.startControl(),this._curMoveX=this._baseMoveX,this._baseAngle=0,this.rotateAngle=0,this._changedX=0,this._rotateScale=1,this.transform(!0),this.endControl());for(var i="",o=this.startAngle;o<=this.endAngle;o+=this.gapAngle)i+='<li><div class="number">'+o+'</div><div class="bg"></div></li>';this.$lineation.innerHTML=i,this.$lineation.style.width=this.lineationWidth+"px",this.$lineation.style[r]="translateX("+this._curMoveX+"px)",this.rotateSlider?this.$cropRotate.style.visibility="":this.$cropRotate.style.visibility="hidden"},s.prototype.initChilds=function(){this.$cropMask=document.querySelector("#"+this.id+" .crop-mask");var t=window.getComputedStyle(this.$cropMask);this.maskViewSize={width:parseInt(t.getPropertyValue("width")),height:parseInt(t.getPropertyValue("height"))},this.$cropCover=document.querySelector("#"+this.id+" .crop-cover"),this.cropCoverContext=this.$cropCover.getContext("2d"),this.$cropCover.width=this.maskViewSize.width*window.devicePixelRatio,this.$cropCover.height=this.maskViewSize.height*window.devicePixelRatio,this.$cropScale=document.querySelector("#"+this.id+" .crop-scale"),this.$scaleBtn=document.querySelector("#"+this.id+" .scale-btn"),this.$scaleNum=document.querySelector("#"+this.id+" .scale-num"),this.$scaleOneTimes=document.querySelector("#"+this.id+" .one-times-icon"),this.$scaleTwoTimes=document.querySelector("#"+this.id+" .two-times-icon"),this.$scaleContainer=document.querySelector("#"+this.id+" .scale-container"),this.$scaleValue=document.querySelector("#"+this.id+" .scale-value"),this.$maxScale=document.querySelector("#"+this.id+" .max-scale"),this.scaleDownX=0,this.scaleInitLeft=this.$scaleBtn.getBoundingClientRect().left,this.scaleCurLeft=this.scaleInitLeft,this.scaleWidth=this.$scaleNum.getBoundingClientRect().width},s.prototype.updateBox=function(t){this.size=t.size,this.positionOffset=null!=t.positionOffset?t.positionOffset:{top:0,left:0},this.cropSizePercent=null!=t.cropSizePercent?t.cropSizePercent:.5,this.times=this.size.width/this.maskViewSize.width>this.size.height/this.maskViewSize.height?this.size.width/this.maskViewSize.width/this.cropSizePercent:this.size.height/this.maskViewSize.height/this.cropSizePercent,this.cropRect={width:this.size.width/this.times,height:this.size.height/this.times},this.cropRect.left=(this.maskViewSize.width-this.cropRect.width)/2-this.positionOffset.left,this.cropRect.top=(this.maskViewSize.height-this.cropRect.height)/2-this.positionOffset.top,this.cropPoints=this.rectToPoints(this.cropRect),this.cropCenter=this.getPointsCenter(this.cropPoints),this.borderDraw(this.$cropCover),this.coverDraw(this.$cropCover);var e=null!=t.src?t.src:this.src;this.setImage(e)},s.prototype.getControlPoints=function(t){return t.touches?t.touches:[{clientX:t.clientX,clientY:t.clientY}]},s.prototype.getControlEvents=function(){return this.isSupportTouch?{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"}:{start:"mousedown",move:"mousemove",end:"mouseup",cancel:"mouseleave"}},s.prototype.initScaleSlider=function(t){t&&(this.scaleSlider=null!=t.scaleSlider&&t.scaleSlider,this.maxScale=t.maxScale?t.maxScale:1),this.scaleTimes=this.initScale,this.maxScale=this.initScale<this.maxScale?this.maxScale:Math.ceil(this.initScale),this._scaleMoveX=0,this.scaleCurLeft=this.scaleInitLeft,this.$maxScale.innerText="(x"+this.maxScale+")",this.$scaleBtn.style[r]="translateX(0px)",this.$scaleValue.style.width="0px",this.scaleSlider?this.$cropScale.style.visibility="":this.$cropScale.style.visibility="hidden",this.transform(!1,!0)},s.prototype.construct=function(){var t="";t+='<div class="crop-component">',t+='<p class="crop-title">'+this.title+"</p>",t+='<div class="crop-mask">',t+='<canvas class="crop-cover"></canvas>',t+="</div>",this.scaleSlider?t+='<div class="crop-scale">':t+='<div class="crop-scale" style="visibility:hidden;">',t+='<div class="one-times-icon"></div>',t+='<div class="scale-container">',t+='<div class="scale-num"><span class="scale-value" style="width:0px;"></span><span class="scale-btn" style="left:-8px;"></span></div>',t+="</div>",t+='<div class="two-times-icon"></div>',t+='<div class="max-scale"></div>',t+="</div>",this.rotateSlider?t+='<div class="crop-rotate">':t+='<div class="crop-rotate" style="visibility:hidden;">',t+='<ul class="lineation">',t+="</ul>",t+='<div class="current"></div>',t+="</div>",t+='<div class="crop-btns" style="visibility:hidden;"></div>',t+="</div>",this.$target=document.createElement("div"),this.$target.id=this.id,this.$target.classList.add("crop-whole-cover"),this.visible?this.$target.style.visibility="":this.$target.style.visibility="hidden",this.$target.innerHTML=t,this.$container.appendChild(this.$target)},s.prototype.defaultBorderDraw=function(t){var e=this.borderWidth,n=this.boldCornerLen;n=n>=2*e?n:2*e;var i=t.width,r=t.height;this.cropCoverContext.clearRect(0,0,i,r),this.cropCoverContext.fillStyle=this.coverColor,this.cropCoverContext.fillRect(0,0,i,r);var o={left:this.cropRect.left*window.devicePixelRatio,top:this.cropRect.top*window.devicePixelRatio,width:this.cropRect.width*window.devicePixelRatio,height:this.cropRect.height*window.devicePixelRatio};this.cropCoverContext.fillStyle=this.borderColor,this.cropCoverContext.fillRect(o.left,o.top,o.width,o.height),this.boldCornerLen>0&&(this.cropCoverContext.fillRect(o.left-e,o.top-e,n,n),this.cropCoverContext.fillRect(o.left+o.width-n+e,o.top-e,n,n),this.cropCoverContext.fillRect(o.left-e,o.top+o.height-n+e,n,n),this.cropCoverContext.fillRect(o.left+o.width-n+e,o.top+o.height-n+e,n,n)),this.cropCoverContext.clearRect(o.left+e,o.top+e,o.width-2*e,o.height-2*e)},s.prototype.init=function(){var t=this.contentWidth/2,e=this.contentHeight/2;this.initContentPoints=[{x:-t,y:e},{x:t,y:e},{x:t,y:-e},{x:-t,y:-e}],this.contentPoints=this.initContentPoints.slice(),this.size.width/this.size.height>this.contentWidth/this.contentHeight?this.initScale=this.size.width/this.contentWidth:this.initScale=this.size.height/this.contentHeight,this.reset()},s.prototype.reset=function(){this.startControl(),this._contentCurMoveX=-this.positionOffset.left,this._contentCurMoveY=-this.positionOffset.top,this._rotateScale=1,this._baseAngle=0,this.rotateAngle=0,this._curMoveX=this._baseMoveX,this._changedX=0,this.$lineation.style[r]="translateX("+this._baseMoveX+"px)",this.initScaleSlider(),this.endControl()},s.prototype.load=function(){var t=this;t.originImage.onload=function(){e.getData(t.originImage,(function(){t._orientation=e.getTag(this,"Orientation"),t.getRealCotentSize(),t.transformCoordinates(),t.init()}))}},s.prototype.setImage=function(t){if(null!=t&&""!=t){var e=this,n=Object.prototype.toString.call(t);"[object String]"===n?(e.src=t,e.originImage=new Image,e.originImage.src=e.src,e.load(),e.uploadCallback(e.src)):"[object File]"===n&&e.fileToSrc(t,(function(t){e.src=t,e.originImage=new Image,e.originImage.src=e.src,e.load(),e.uploadCallback(e.src)}))}},s.prototype.show=function(t){t&&this.setImage(t),this.visible=!0,this.$target.style.visibility=""},s.prototype.hide=function(){this.visible=!1,this.$target.style.visibility="hidden"},s.prototype.close=function(){this.hide(),this.closeCallback()},s.prototype.crop=function(){this.getCropImage(),this.cropCallback(this.$resultCanvas),this.hide()},s.prototype.uploadInput=function(t){var e=t.target.files;e.length>0&&this.show(e[0]),this.$uploadInput.value=""},s.prototype.around=function(){this.startControl(),this.rotateAngle=(this._baseAngle-90)%360,this._baseAngle=this.rotateAngle,this._curMoveX=this._baseMoveX,this._changedX=0,this._rotateScale=1,this.$lineation.style[r]="translateX("+this._baseMoveX+"px)",this.transform(!1,!0),this.endControl()},s.prototype.bindEvent=function(){var t=this,e=this.getControlEvents();t.$scaleBtn.addEventListener(e.start,(function(e){t.scaleDownX=t.getControlPoints(e)[0].clientX,t.startControl()})),t.$scaleContainer.addEventListener(e.move,(function(e){t.scaleMove(e),e.stopPropagation()})),t.$scaleContainer.addEventListener(e.cancel,t.endControl.bind(t)),t.$scaleContainer.addEventListener(e.end,t.endControl.bind(t)),t.$scaleContainer.addEventListener("click",(function(e){t.startControl();var n=t.$scaleBtn.getBoundingClientRect();t.scaleDownX<=0&&(t.scaleDownX=n.left+1*n.width/2),t.scaleMove(e),t.endControl()})),t.$scaleOneTimes.addEventListener("click",(function(){t.startControl(),t.scaleMoveAt(0),t.endControl()})),t.$scaleTwoTimes.addEventListener("click",(function(){t.startControl(),t.scaleMoveAt(t.scaleWidth),t.endControl()})),t.$cropRotate.addEventListener(e.start,(function(e){var n=t.getControlPoints(e);t.startControl(n)})),t.$cropRotate.addEventListener(e.move,(function(e){var n=t.getControlPoints(e);if(t._downPoints&&t._downPoints.length>0&&!t._multiPoint){var i=n[0].clientX-t._downPoints[0].clientX,o=t._curMoveX+i;if(o<=0&&o>=t.rotateWidth-t.lineationWidth){var s=(o-t._baseMoveX)/t.lineationWidth*(t.endAngle-t.startAngle+t.gapAngle);t._curMoveX=o,t._changedX=i,t.$lineation.style[r]="translateX("+o+"px)",t.rotateAngle=t._baseAngle+s,t.transform(!0),t._downPoints=n}}e.stopPropagation(),e.preventDefault()})),t.$cropRotate.addEventListener(e.end,t.endControl.bind(t)),t.$cropRotate.addEventListener(e.cancel,t.endControl.bind(t));var n=t.isSupportTouch?t.$container:t.$cropMask;n.addEventListener(e.start,(function(e){var n=t.getControlPoints(e);if(t.startControl(n),t._multiPoint=!1,t._downPoints&&t._downPoints.length>=2){t._multiPoint=!0;var i={clientX:(t._downPoints[0].clientX+t._downPoints[1].clientX)/2,clientY:(t._downPoints[0].clientY+t._downPoints[1].clientY)/2};t.fingerLen=Math.sqrt(Math.pow(t._downPoints[0].clientX-t._downPoints[1].clientX,2)+Math.pow(t._downPoints[0].clientY-t._downPoints[1].clientY,2)),t.fingerScale=1,t.fingerCenter={x:i.clientX-t.maskViewSize.width/2,y:t.maskViewSize.height/2-i.clientY}}}));var i=!!t.passiveSupported&&{passive:!1,capture:!1};n.addEventListener(e.move,(function(e){var n=t.getControlPoints(e);if(t._downPoints&&t._downPoints.length>0)if(t._multiPoint){var i=Math.sqrt(Math.pow(n[0].clientX-n[1].clientX,2)+Math.pow(n[0].clientY-n[1].clientY,2))/t.fingerLen;t.scaleTimes=t.scaleTimes/t.fingerScale*i;var r=t.getFingerScaleTranslate(i/t.fingerScale);t._contentCurMoveX-=r.translateX,t._contentCurMoveY+=r.translateY,t.fingerScale=i,t.transform(!1,!0)}else t.contentMove(n);t.visible&&e.preventDefault()}),i),n.addEventListener(e.end,t.endControl.bind(t)),n.addEventListener(e.cancel,t.endControl.bind(t))},s.prototype.getFingerScaleTranslate=function(t){for(var e=[],n=this.getPointsCenter(this.contentPoints),i=0;i<this.contentPoints.length;i++){var r=this.contentPoints[i];e.push({x:r.x*t-this.fingerCenter.x*(t-1),y:r.y*t-this.fingerCenter.y*(t-1)})}var o=this.getPointsCenter(e);return{translateX:n.x-o.x,translateY:n.y-o.y}},s.prototype.getRealCotentSize=function(){this.contentWidth=this.originImage.width,this.contentHeight=this.originImage.height,this._orientation>4&&(this.contentWidth=this.originImage.height,this.contentHeight=this.originImage.width)},s.prototype.transformCoordinates=function(){this.$cropContent&&this.$cropMask.removeChild(this.$cropContent),this.$cropContent=document.createElement("canvas"),this.$cropContent.width=this.contentWidth,this.$cropContent.height=this.contentHeight;var t=this.$cropContent.getContext("2d"),e=this.originImage.width,n=this.originImage.height;switch(this._orientation){case 2:t.translate(e,0),t.scale(-1,1);break;case 3:t.translate(e,n),t.rotate(Math.PI);break;case 4:t.translate(0,n),t.scale(1,-1);break;case 5:t.rotate(.5*Math.PI),t.scale(1,-1);break;case 6:t.rotate(.5*Math.PI),t.translate(0,-n);break;case 7:t.rotate(.5*Math.PI),t.translate(e,-n),t.scale(-1,1);break;case 8:t.rotate(-.5*Math.PI),t.translate(-e,0)}t.drawImage(this.originImage,0,0,e,n),this._initTransform="translate3d(-50%,-50%,0)",this.$cropContent.classList.add("crop-content"),this.$cropContent.style.position="absolute",this.$cropContent.style.left="50%",this.$cropContent.style.top="50%",this.$cropContent.style[r]=this._initTransform,this.$cropMask.insertBefore(this.$cropContent,this.$cropCover)},s.prototype.getCropImage=function(){var t=this.scaleTimes/this.times*this._rotateScale,e=this.contentWidth,n=this.contentHeight,i=this.size.width,r=this.size.height,o=1;(e<i||n<r)&&(i/e>r/n?(n*=o=i/e,e=i):(e*=o=r/n,n=r));var s={x:e/2,y:n/2},a=document.createElement("canvas");a.width=e,a.height=n;var c=a.getContext("2d");c.translate(s.x,s.y),c.scale(t*this.times/o,t*this.times/o),c.translate((this._contentCurMoveX+this.positionOffset.left)/t*o,(this._contentCurMoveY+this.positionOffset.top)/t*o),c.rotate(this.rotateAngle/180*Math.PI),c.translate(-s.x,-s.y),c.drawImage(this.$cropContent,0,0,e,n);var l=document.createElement("canvas");l.width=i,l.height=r,l.getContext("2d").drawImage(a,(e-i)/2,(n-r)/2,i,r,0,0,i,r),this.$resultCanvas=l},s.prototype.endControl=function(){if(this._isControl){var t=this;if(this._downPoints=[],this.scaleDownX=0,this.$cropContent&&!this.isWholeCover(this.contentPoints,this.cropPoints)){var e=this.scaleTimes/this.times*this._rotateScale,n="";n+=" scale("+e+")",n+=" translateX("+this._contentCurMoveX/e+"px) translateY("+this._contentCurMoveY/e+"px)",n+=" rotate("+this.rotateAngle+"deg) ";var s=this.getCoverTransform(n),a=this.getTransformMatrix(s);if(this._contentCurMoveX=a.e,this._contentCurMoveY=a.f,this.contentPoints=this.getTransformPoints("scaleY(-1)"+s,this.initContentPoints),this.debug){this.$cropContent.style[o]="transform .5s linear";var c=s.indexOf(n)+n.length,l=s.substring(c,s.length).trim().split(" "),h=0,u=this._initTransform+n+l[h];this.$cropContent.style[r]=u,this.$cropContent.addEventListener(i,(function(){++h<s.length&&(u+=l[h],t.$cropContent.style[r]=u)}))}else this.$cropContent.style[r]=this._initTransform+s}this._isControl=!1}},s.prototype.startControl=function(t){t=t||[],this._isControl&&!this.isTwoFingerEvent(t)||(this._isControl=!0,this.$cropContent&&(this.$cropContent.style[o]="none"),this._downPoints=t)},s.prototype.isTwoFingerEvent=function(t){return!!(this._isControl&&this._downPoints&&1==this._downPoints.length&&t.length>=2&&(t[0].clientX==this._downPoints[0].clientX&&t[0].clientY==this._downPoints[0].clientY||t[1].clientX==this._downPoints[0].clientX&&t[1].clientY==this._downPoints[0].clientY))},s.prototype.scaleMove=function(t){if(this.scaleDownX>0){var e=this.getControlPoints(t)[0].clientX,n=e-this.scaleDownX,i=this.scaleCurLeft+n;if(i>=this.scaleInitLeft&&i<=this.scaleWidth+this.scaleInitLeft){var r=this._scaleMoveX;r||(r=0);var o=r+n;this.scaleDownX=e,this.scaleMoveAt(o)}}},s.prototype.scaleMoveAt=function(t){this.$scaleBtn.style[r]="translateX("+t+"px)",this.$scaleValue.style.width=t+"px",this._scaleMoveX=t,this.scaleCurLeft=this.scaleInitLeft+t,this.scaleTimes=this.initScale+1*t/this.scaleWidth*(this.maxScale-this.initScale),this.transform(!1,!0)},s.prototype.contentMove=function(t){var e=t[0],n=e.clientX-this._downPoints[0].clientX,i=e.clientY-this._downPoints[0].clientY;this._contentCurMoveX+=n,this._contentCurMoveY+=i,this._downPoints=t,this.transform()},s.prototype.transform=function(t,e){if(this.$cropContent){var n=this.scaleTimes/this.times*this._rotateScale,i="";if(i+=" scale("+n+")",i+=" translateX("+this._contentCurMoveX/n+"px) translateY("+this._contentCurMoveY/n+"px)",i+=" rotate("+this.rotateAngle+"deg)",e){i=this.getCoverTransform(i,!0);var o=this.getTransformMatrix(i);this._contentCurMoveX=o.e,this._contentCurMoveY=o.f}if(t){var s=this.getTransformPoints("scaleY(-1)"+i,this.initContentPoints),a=this.getCoverRectScale(s,this.cropPoints),c=this._changedX,l=this._curMoveX-c-this._baseMoveX,h=this.getPointsCenter(s),u={x:h.x-this.cropCenter.x,y:h.y-this.cropCenter.y},d=Math.abs(c)/Math.abs(l);a>1?(this._rotateScale=this._rotateScale*a,n*=a):this.vecLen(u)<1&&d>0&&(a<1-d&&(a=1-d),this._rotateScale*a>1?this._rotateScale=this._rotateScale*a:(this._rotateScale=1,a=1),n*=a)}i="",i+=" scale("+n+")",i+=" translateX("+this._contentCurMoveX/n+"px) translateY("+this._contentCurMoveY/n+"px)",i+=" rotate("+this.rotateAngle+"deg)",this.$cropContent.style[r]=this._initTransform+i,this.contentPoints=this.getTransformPoints("scaleY(-1)"+i,this.initContentPoints)}},s.prototype.getCoverRectScale=function(t,e){for(var n=0,i=0;i<e.length;i++){var r=this.getCoverPointScale(e[i],t);r>n&&(n=r)}return n},s.prototype.isWholeCover=function(t,e){for(var n=0;n<e.length;n++)if(!this.isPointInRectCheckByLen(e[n],t))return!1;return!0},s.prototype.getCoverPointScale=function(t,e){var n=this.getPCVectorProjOnUpAndRight(t,e),i=this.vecLen(n.uproj),r=this.vecLen(n.up)/2,o=this.vecLen(n.rproj),s=this.vecLen(n.right)/2;return i/r>o/s?1+(i-r)/r:1+(o-s)/s},s.prototype.getCoverTransform=function(t,e){var n=this.getCoveRect(this.cropPoints,this.rotateAngle);e=e||!1;var i=1,r=1,o={x:this.contentPoints[1].x-this.contentPoints[2].x,y:this.contentPoints[1].y-this.contentPoints[2].y},s={x:this.contentPoints[1].x-this.contentPoints[0].x,y:this.contentPoints[1].y-this.contentPoints[0].y},a={x:n[1].x-n[2].x,y:n[1].y-n[2].y},c={x:n[1].x-n[0].x,y:n[1].y-n[0].y},l=this.vecAngle(o,a);Math.abs(180-l)<Math.abs(90-l)||Math.abs(0-l)<Math.abs(90-l)?(i=this.vecLen(a)/this.vecLen(o),r=this.vecLen(c)/this.vecLen(s)):(i=this.vecLen(a)/this.vecLen(s),r=this.vecLen(c)/this.vecLen(o));var h=(i=i<1?1:i)>(r=r<1?1:r)?i:r;if(e&&h>1)return t;for(var u=[],d=0;d<this.contentPoints.length;d++)u.push({x:this.contentPoints[d].x,y:this.contentPoints[d].y});h>1&&(t+=" scale("+h+")",this.scaleTimes=this.scaleTimes*h,u=this.getTransformPoints("scaleY(-1)"+t,this.initContentPoints));var f=this.scaleTimes/this.times*this._rotateScale,p=0,g=this,v=[];do{if((v=this.getOutDetails(this.cropPoints,u)).length>0){p++,v.sort((function(t,e){var n=g.vecLen(t.iv),i=g.vecLen(e.iv);return n<i?1:n>i?-1:0}));var m=v[0],y=m.pcv;l=this.vecAngle(y.up,y.uproj);var x=this.vecLen(y.uproj),C=0;0!=(C=Math.abs(l)<90?-x*m.uOver:x*m.uOver)&&(t+=" translateY("+C/f+"px)");var b=this.vecAngle(y.right,y.rproj),S=this.vecLen(y.rproj),w=0;if(0!=(w=Math.abs(b)<90?S*m.rOver:-S*m.rOver)&&(t+=" translateX("+w/f+"px)"),0!=w||0!=C)for(d=0;d<u.length;d++)u[d].x=u[d].x+m.iv.x,u[d].y=u[d].y+m.iv.y}}while(p<2&&v.length>0);return t},s.prototype.getOutDetails=function(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i];if(!this.isPointInRectCheckByLen(r,e)){var o=this.getPCVectorProjOnUpAndRight(r,e),s={x:0,y:0},a=this.vecLen(o.uproj),c=this.vecLen(o.up)/2,l=this.vecLen(o.rproj),h=this.vecLen(o.right)/2,u=0,d=0;a>c&&(u=(a-c)/a,s.x+=o.uproj.x*u,s.y+=o.uproj.y*u),l>h&&(d=(l-h)/l,s.x+=o.rproj.x*d,s.y+=o.rproj.y*d),n.push({x:r.x,y:r.y,iv:s,uOver:u,rOver:d,pcv:o})}}return n},s.prototype.getCoveRect=function(t,e){e<0?e=90+e%90:e%=90;var n=e/180*Math.PI,i={x:t[1].x-t[2].x,y:t[1].y-t[2].y},r={x:t[1].x-t[0].x,y:t[1].y-t[0].y},o=this.vecLen(r),s=this.vecLen(i),a=[];return a[0]={},a[0].x=t[0].x+o*Math.sin(n)*Math.sin(n),a[0].y=t[0].y+o*Math.sin(n)*Math.cos(n),a[1]={},a[1].x=t[1].x+s*Math.sin(n)*Math.cos(n),a[1].y=t[1].y-s*Math.sin(n)*Math.sin(n),a[2]={},a[2].x=t[2].x-o*Math.sin(n)*Math.sin(n),a[2].y=t[2].y-o*Math.sin(n)*Math.cos(n),a[3]={},a[3].x=t[3].x-s*Math.sin(n)*Math.cos(n),a[3].y=t[3].y+s*Math.sin(n)*Math.sin(n),a},s.prototype.getTransformPoints=function(t,e){for(var i=this.getTransformMatrix(t),r=[],o=0;o<e.length;o++){var s={x:e[o].x,y:e[o].y};s=n.applyToPoint(i,s),r.push(s)}return r.reverse(),r},s.prototype.getPointsCenter=function(t){return{x:(t[0].x+t[2].x)/2,y:(t[0].y+t[2].y)/2}},s.prototype.rectToPoints=function(t){var e=[];return e.push({x:-(this.maskViewSize.width/2-t.left),y:this.maskViewSize.height/2-t.top}),e.push({x:e[0].x+t.width,y:e[0].y}),e.push({x:e[1].x,y:e[1].y-t.height}),e.push({x:e[0].x,y:e[2].y}),e},s.prototype.getTransformMatrix=function(t){for(var e=t.split(" "),i=[],r=0;r<e.length;r++)if(""!=e[r].trim()){var o,s=this.getTransformFunctionName(e[r]);o="rotate"!=s.name?n[s.name](s.params[0],s.params[1]):n[s.name](s.params[0]),i.push(o)}return n.compose(i)},s.prototype.getTransformFunctionName=function(t){for(var e=t.indexOf("("),n=t.indexOf(")"),i={},r=t.substring(e+1,n).split(","),o=[],s=0;s<r.length;s++)o.push(parseFloat(r[s]));i.params=o;var a=t.substring(0,e).toLowerCase(),c=0;return-1!=a.indexOf("scale")?(i.name="scale",c=1):-1!=a.indexOf("translate")?i.name="translate":-1!=a.indexOf("skew")?i.name="skewDEG":-1!=a.indexOf("rotate")&&(i.name="rotateDEG"),-1!=a.indexOf("x")?i.params.push(c):-1!=a.indexOf("y")?i.params.unshift(c):-1==a.indexOf("rotate")&&i.params.length<=1&&i.params.push(i.params[0]),i},s.prototype.getProjectionVector=function(t,e){var n=this.vecLen(e),i=t.x*e.x+t.y*e.y;return{x:i/Math.pow(n,2)*e.x,y:i/Math.pow(n,2)*e.y}},s.prototype.getPCVectorProjOnUpAndRight=function(t,e){var n={x:e[1].x-e[2].x,y:e[1].y-e[2].y},i={x:e[1].x-e[0].x,y:e[1].y-e[0].y},r=this.getPointsCenter(e),o={x:t.x-r.x,y:t.y-r.y};return{up:n,uproj:this.getProjectionVector(o,n),right:i,rproj:this.getProjectionVector(o,i)}},s.prototype.isPointInRectCheckByLen=function(t,e){var n=this.getPCVectorProjOnUpAndRight(t,e),i=Math.round(100*this.vecLen(n.uproj)),r=Math.round(this.vecLen(n.up)/2*100),o=Math.round(100*this.vecLen(n.rproj)),s=Math.round(this.vecLen(n.right)/2*100);return i<=r&&o<=s},s.prototype.isPointInRectCheckByAngle=function(t,e){for(var n=[],i=0;i<e.length;i++){var r=e[i];n.push({x:r.x-t.x,y:r.y-t.y})}var o=0,s=0;for(i=0;i<n.length;i++){var a=this.vecLen(n[i]);(0==a||a<s)&&(o=i,s=a)}a=n.length;var c,l=n.splice(o,1)[0],h=l,u=[];for(i=1;i<a;i++){var d=this.getMinAngle(h,n);h=d.vec,n.splice(d.index,1),u.push(d.angle),1==n.length&&(c=n[0])}u.push(this.getMinAngle(c,[l]).angle);var f=0;for(i=0;i<u.length;i++)f+=u[i];return!((f=f.toPrecision(12))<360)},s.prototype.getMinAngle=function(t,e){for(var n=this.vecAngle(t,e[0]),i=0,r=1;r<e.length;r++){var o=this.vecAngle(t,e[r]);o<n&&(n=o,i=r)}return{angle:n,vec:e[i],index:i}},s.prototype.vecAngle=function(t,e){var n=(t.x*e.x+t.y*e.y)/(this.vecLen(t)*this.vecLen(e));return Math.abs(n)>1&&(n=n>0?1:-1),180*Math.acos(n)/Math.PI},s.prototype.vecLen=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},s.prototype.fileToSrc=function(t,e){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsDataURL(t)},s})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r,o;r=[],void 0===(o="function"==typeof(i=function(){var t="undefined"!=typeof document?document.createElement("p").style:{},e=["O","ms","Moz","Webkit"],n=/([A-Z])/g,i={};function r(n){if(n=n.replace(/-([a-z])/g,(function(t,e){return e.toUpperCase()})),void 0!==t[n])return n;for(var i=n.charAt(0).toUpperCase()+n.slice(1),r=e.length;r--;){var o=e[r]+i;if(void 0!==t[o])return o}return n}return{prefix:function(t){return t in i?i[t]:i[t]=r(t)},dash:function(t){return t=r(t),n.test(t)&&(t=t.replace(n,"-$1"),n.lastIndex=0),t.toLowerCase()}}})?i.apply(e,r):i)||(t.exports=o)},function(t,e,i){var r;(function(){var i=!1,o=function(t){return t instanceof o?t:this instanceof o?void(this.EXIFwrapped=t):new o(t)};t.exports&&(e=t.exports=o),e.EXIF=o;var s=o.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},a=o.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},c=o.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},l=o.IFD1Tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},h=o.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function u(t){return!!t.exifdata}function d(t,e){function n(n){var r=f(n);t.exifdata=r||{};var s=function(t){var e=new DataView(t);i&&console.log("Got file of length "+t.byteLength);if(255!=e.getUint8(0)||216!=e.getUint8(1))return i&&console.log("Not a valid JPEG"),!1;var n=2,r=t.byteLength,o=function(t,e){return 56===t.getUint8(e)&&66===t.getUint8(e+1)&&73===t.getUint8(e+2)&&77===t.getUint8(e+3)&&4===t.getUint8(e+4)&&4===t.getUint8(e+5)};for(;n<r;){if(o(e,n)){var s=e.getUint8(n+7);s%2!=0&&(s+=1),0===s&&(s=4);var a=n+8+s,c=e.getUint16(n+6+s);return g(t,a,c)}n++}}(n);if(t.iptcdata=s||{},o.isXmpEnabled){var a=function(t){if(!("DOMParser"in self))return;var e=new DataView(t);i&&console.log("Got file of length "+t.byteLength);if(255!=e.getUint8(0)||216!=e.getUint8(1))return i&&console.log("Not a valid JPEG"),!1;var n=2,r=t.byteLength,o=new DOMParser;for(;n<r-4;){if("http"==y(e,n,4)){var s=n-1,a=e.getUint16(n-2)-1,c=y(e,s,a),l=c.indexOf("xmpmeta>")+8,h=(c=c.substring(c.indexOf("<x:xmpmeta"),l)).indexOf("x:xmpmeta")+10;return c=c.slice(0,h)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+c.slice(h),b(o.parseFromString(c,"text/xml"))}n++}}(n);t.xmpdata=a||{}}e&&e.call(t)}if(t.src)if(/^data\:/i.test(t.src))n(function(t,e){e=e||t.match(/^data\:([^\;]+)\;base64,/im)[1]||"",t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var n=atob(t),i=n.length,r=new ArrayBuffer(i),o=new Uint8Array(r),s=0;s<i;s++)o[s]=n.charCodeAt(s);return r}(t.src));else if(/^blob\:/i.test(t.src)){(s=new FileReader).onload=function(t){n(t.target.result)},function(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="blob",n.onload=function(t){200!=this.status&&0!==this.status||e(this.response)},n.send()}(t.src,(function(t){s.readAsArrayBuffer(t)}))}else{var r=new XMLHttpRequest;r.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";n(r.response),r=null},r.open("GET",t.src,!0),r.responseType="arraybuffer",r.send(null)}else if(self.FileReader&&(t instanceof self.Blob||t instanceof self.File)){var s;(s=new FileReader).onload=function(t){i&&console.log("Got file of length "+t.target.result.byteLength),n(t.target.result)},s.readAsArrayBuffer(t)}}function f(t){var e=new DataView(t);if(i&&console.log("Got file of length "+t.byteLength),255!=e.getUint8(0)||216!=e.getUint8(1))return i&&console.log("Not a valid JPEG"),!1;for(var n,r=2,o=t.byteLength;r<o;){if(255!=e.getUint8(r))return i&&console.log("Not a valid marker at offset "+r+", found: "+e.getUint8(r)),!1;if(n=e.getUint8(r+1),i&&console.log(n),225==n)return i&&console.log("Found 0xFFE1 marker"),x(e,r+4,e.getUint16(r+2));r+=2+e.getUint16(r+2)}}var p={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function g(t,e,n){for(var i,r,o,s,a=new DataView(t),c={},l=e;l<e+n;)28===a.getUint8(l)&&2===a.getUint8(l+1)&&(s=a.getUint8(l+2))in p&&((o=a.getInt16(l+3))+5,r=p[s],i=y(a,l+5,o),c.hasOwnProperty(r)?c[r]instanceof Array?c[r].push(i):c[r]=[c[r],i]:c[r]=i),l++;return c}function v(t,e,n,r,o){var s,a,c,l=t.getUint16(n,!o),h={};for(c=0;c<l;c++)s=n+12*c+2,!(a=r[t.getUint16(s,!o)])&&i&&console.log("Unknown tag: "+t.getUint16(s,!o)),h[a]=m(t,s,e,n,o);return h}function m(t,e,n,i,r){var o,s,a,c,l,h,u=t.getUint16(e+2,!r),d=t.getUint32(e+4,!r),f=t.getUint32(e+8,!r)+n;switch(u){case 1:case 7:if(1==d)return t.getUint8(e+8,!r);for(o=d>4?f:e+8,s=[],c=0;c<d;c++)s[c]=t.getUint8(o+c);return s;case 2:return y(t,o=d>4?f:e+8,d-1);case 3:if(1==d)return t.getUint16(e+8,!r);for(o=d>2?f:e+8,s=[],c=0;c<d;c++)s[c]=t.getUint16(o+2*c,!r);return s;case 4:if(1==d)return t.getUint32(e+8,!r);for(s=[],c=0;c<d;c++)s[c]=t.getUint32(f+4*c,!r);return s;case 5:if(1==d)return l=t.getUint32(f,!r),h=t.getUint32(f+4,!r),(a=new Number(l/h)).numerator=l,a.denominator=h,a;for(s=[],c=0;c<d;c++)l=t.getUint32(f+8*c,!r),h=t.getUint32(f+4+8*c,!r),s[c]=new Number(l/h),s[c].numerator=l,s[c].denominator=h;return s;case 9:if(1==d)return t.getInt32(e+8,!r);for(s=[],c=0;c<d;c++)s[c]=t.getInt32(f+4*c,!r);return s;case 10:if(1==d)return t.getInt32(f,!r)/t.getInt32(f+4,!r);for(s=[],c=0;c<d;c++)s[c]=t.getInt32(f+8*c,!r)/t.getInt32(f+4+8*c,!r);return s}}function y(t,e,i){var r="";for(n=e;n<e+i;n++)r+=String.fromCharCode(t.getUint8(n));return r}function x(t,e){if("Exif"!=y(t,e,4))return i&&console.log("Not valid EXIF data! "+y(t,e,4)),!1;var n,r,o,u,d,f=e+6;if(18761==t.getUint16(f))n=!1;else{if(19789!=t.getUint16(f))return i&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;n=!0}if(42!=t.getUint16(f+2,!n))return i&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var p=t.getUint32(f+4,!n);if(p<8)return i&&console.log("Not valid TIFF data! (First offset less than 8)",t.getUint32(f+4,!n)),!1;if((r=v(t,f,f+p,a,n)).ExifIFDPointer)for(o in u=v(t,f,f+r.ExifIFDPointer,s,n)){switch(o){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":u[o]=h[o][u[o]];break;case"ExifVersion":case"FlashpixVersion":u[o]=String.fromCharCode(u[o][0],u[o][1],u[o][2],u[o][3]);break;case"ComponentsConfiguration":u[o]=h.Components[u[o][0]]+h.Components[u[o][1]]+h.Components[u[o][2]]+h.Components[u[o][3]]}r[o]=u[o]}if(r.GPSInfoIFDPointer)for(o in d=v(t,f,f+r.GPSInfoIFDPointer,c,n)){switch(o){case"GPSVersionID":d[o]=d[o][0]+"."+d[o][1]+"."+d[o][2]+"."+d[o][3]}r[o]=d[o]}return r.thumbnail=function(t,e,n,i){var r=function(t,e,n){var i=t.getUint16(e,!n);return t.getUint32(e+2+12*i,!n)}(t,e+n,i);if(!r)return{};if(r>t.byteLength)return{};var o=v(t,e,e+r,l,i);if(o.Compression)switch(o.Compression){case 6:if(o.JpegIFOffset&&o.JpegIFByteCount){var s=e+o.JpegIFOffset,a=o.JpegIFByteCount;o.blob=new Blob([new Uint8Array(t.buffer,s,a)],{type:"image/jpeg"})}break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",o.Compression)}else 2==o.PhotometricInterpretation&&console.log("Thumbnail image format is RGB, which is not implemented.");return o}(t,f,p,n),r}function C(t){var e={};if(1==t.nodeType){if(t.attributes.length>0){e["@attributes"]={};for(var n=0;n<t.attributes.length;n++){var i=t.attributes.item(n);e["@attributes"][i.nodeName]=i.nodeValue}}}else if(3==t.nodeType)return t.nodeValue;if(t.hasChildNodes())for(var r=0;r<t.childNodes.length;r++){var o=t.childNodes.item(r),s=o.nodeName;if(null==e[s])e[s]=C(o);else{if(null==e[s].push){var a=e[s];e[s]=[],e[s].push(a)}e[s].push(C(o))}}return e}function b(t){try{var e={};if(t.children.length>0)for(var n=0;n<t.children.length;n++){var i=t.children.item(n),r=i.attributes;for(var o in r){var s=r[o],a=s.nodeName,c=s.nodeValue;void 0!==a&&(e[a]=c)}var l=i.nodeName;if(void 0===e[l])e[l]=C(i);else{if(void 0===e[l].push){var h=e[l];e[l]=[],e[l].push(h)}e[l].push(C(i))}}else e=t.textContent;return e}catch(t){console.log(t.message)}}o.enableXmp=function(){o.isXmpEnabled=!0},o.disableXmp=function(){o.isXmpEnabled=!1},o.getData=function(t,e){return!((self.Image&&t instanceof self.Image||self.HTMLImageElement&&t instanceof self.HTMLImageElement)&&!t.complete)&&(u(t)?e&&e.call(t):d(t,e),!0)},o.getTag=function(t,e){if(u(t))return t.exifdata[e]},o.getIptcTag=function(t,e){if(u(t))return t.iptcdata[e]},o.getAllTags=function(t){if(!u(t))return{};var e,n=t.exifdata,i={};for(e in n)n.hasOwnProperty(e)&&(i[e]=n[e]);return i},o.getAllIptcTags=function(t){if(!u(t))return{};var e,n=t.iptcdata,i={};for(e in n)n.hasOwnProperty(e)&&(i[e]=n[e]);return i},o.pretty=function(t){if(!u(t))return"";var e,n=t.exifdata,i="";for(e in n)n.hasOwnProperty(e)&&("object"==typeof n[e]?n[e]instanceof Number?i+=e+" : "+n[e]+" ["+n[e].numerator+"/"+n[e].denominator+"]\r\n":i+=e+" : ["+n[e].length+" values]\r\n":i+=e+" : "+n[e]+"\r\n");return i},o.readFromBinaryFile=function(t){return f(t)},void 0===(r=function(){return o}.apply(e,[]))||(t.exports=r)}).call(this)},function(t,e,n){"use strict";function i(t,e){return Array.isArray(e)?[t.a*e[0]+t.c*e[1]+t.e,t.b*e[0]+t.d*e[1]+t.f]:{x:t.a*e.x+t.c*e.y+t.e,y:t.b*e.x+t.d*e.y+t.f}}function r(t,e){return e.map(e=>i(t,e))}function o(t){return{a:parseFloat(t.a),b:parseFloat(t.b),c:parseFloat(t.c),d:parseFloat(t.d),e:parseFloat(t.e),f:parseFloat(t.f)}}n.r(e);const s=/^matrix\(\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*,\s*([0-9_+-.e]+)\s*\)$/i;function a(t){const e=t.match(s);if(null===e||e.length<7)throw new Error(`'${t}' is not a matrix`);return{a:parseFloat(e[1]),b:parseFloat(e[2]),c:parseFloat(e[3]),d:parseFloat(e[4]),e:parseFloat(e[5]),f:parseFloat(e[6])}}function c(){return{a:1,c:0,e:0,b:0,d:1,f:0}}function l(t){const{a:e,b:n,c:i,d:r,e:o,f:s}=t,a=e*r-n*i;return{a:r/a,b:n/-a,c:i/-a,d:e/a,e:(r*o-i*s)/-a,f:(n*o-e*s)/a}}function h(t){return void 0===t}function u(t){return"number"==typeof t&&!Number.isNaN(t)&&Number.isFinite(t)}function d(t){return"object"==typeof(e=t)&&null!==e&&!Array.isArray(e)&&"a"in t&&u(t.a)&&"b"in t&&u(t.b)&&"c"in t&&u(t.c)&&"d"in t&&u(t.d)&&"e"in t&&u(t.e)&&"f"in t&&u(t.f);var e}function f(t,e=0){return{a:1,c:0,e:t,b:0,d:1,f:e}}function p(...t){const e=(t,e)=>({a:t.a*e.a+t.c*e.b,c:t.a*e.c+t.c*e.d,e:t.a*e.e+t.c*e.f+t.e,b:t.b*e.a+t.d*e.b,d:t.b*e.c+t.d*e.d,f:t.b*e.e+t.d*e.f+t.f});switch((t=Array.isArray(t[0])?t[0]:t).length){case 0:throw new Error("no matrices provided");case 1:return t[0];case 2:return e(t[0],t[1]);default:{const[n,i,...r]=t;return p(e(n,i),...r)}}}function g(...t){return p(...t)}const{cos:v,sin:m,PI:y}=Math;function x(t,e,n){const i=v(t),r=m(t),o={a:i,c:-r,e:0,b:r,d:i,f:0};return h(e)||h(n)?o:p([f(e,n),o,f(-e,-n)])}function C(t,e,n){return x(t*y/180,e,n)}function b(t,e){return h(e)&&(e=t),{a:t,c:0,e:0,b:0,d:e,f:0}}function S(t,e){return{a:1,c:t,e:0,b:e,d:1,f:0}}const{tan:w}=Math;function P(t,e){return{a:1,c:w(t),e:0,b:w(e),d:1,f:0}}function M(t,e){return P(t*Math.PI/180,e*Math.PI/180)}function A(t){return I(t)}function _(t){return I(t)}function I(t){return`matrix(${t.a},${t.b},${t.c},${t.d},${t.e},${t.f})`}function $(t,e=1e10){return{a:Math.round(t.a*e)/e,b:Math.round(t.b*e)/e,c:Math.round(t.c*e)/e,d:Math.round(t.d*e)/e,e:Math.round(t.e*e)/e,f:Math.round(t.f*e)/e}}function T(t,e){const n=null!=t[0].x?t[0].x:t[0][0],i=null!=t[0].y?t[0].y:t[0][1],r=null!=e[0].x?e[0].x:e[0][0],o=null!=e[0].y?e[0].y:e[0][1],s=null!=t[1].x?t[1].x:t[1][0],a=null!=t[1].y?t[1].y:t[1][1],c=null!=e[1].x?e[1].x:e[1][0],h=null!=e[1].y?e[1].y:e[1][1],u=null!=t[2].x?t[2].x:t[2][0],d=null!=t[2].y?t[2].y:t[2][1],f=null!=e[2].x?e[2].x:e[2][0],g=null!=e[2].y?e[2].y:e[2][1];return $(p([{a:r-f,b:o-g,c:c-f,d:h-g,e:f,f:g},l({a:n-u,b:i-d,c:s-u,d:a-d,e:u,f:d})]))}function L(t){return Array.isArray(t)?t.map(e):e(t);function e(t){switch(t.type){case"matrix":if("a"in t&&"b"in t&&"c"in t&&"d"in t&&"e"in t&&"f"in t)return o(t);throw new Error("MISSING_MANDATORY_PARAM");case"translate":if(!("tx"in t))throw new Error("MISSING_MANDATORY_PARAM");return"ty"in t?f(t.tx,t.ty):f(t.tx);case"scale":if(!("sx"in t))throw new Error("MISSING_MANDATORY_PARAM");return"sy"in t?b(t.sx,t.sy):b(t.sx);case"rotate":if(!("angle"in t))throw new Error("MISSING_MANDATORY_PARAM");return"cx"in t&&"cy"in t?C(t.angle,t.cx,t.cy):C(t.angle);case"skewX":if(!("angle"in t))throw new Error("MISSING_MANDATORY_PARAM");return M(t.angle,0);case"skewY":if(!("angle"in t))throw new Error("MISSING_MANDATORY_PARAM");return M(0,t.angle);case"shear":if(!("shx"in t&&"shy"in t))throw new Error("MISSING_MANDATORY_PARAM");return S(t.shx,t.shy);default:throw new Error("UNSUPPORTED_DESCRIPTOR")}}}function R(t,e,n,i){this.message=t,this.expected=e,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,R)}function F(t,e){e=void 0!==e?e:{};var n,i={},r={transformList:ct},o=ct,s="matrix",a="(",c=")",l="translate",h="scale",u="rotate",d="skewX",f="skewY",p=",",g=".",v=/^[eE]/,m=/^[+\-]/,y=/^[0-9]/,x=/^[ \t\r\n]/,C=tt("matrix",!1),b=tt("(",!1),S=tt(")",!1),w=tt("translate",!1),P=tt("scale",!1),M=tt("rotate",!1),A=tt("skewX",!1),_=tt("skewY",!1),I=tt(",",!1),$=nt("fractionalConstant"),T=et(["e","E"],!1,!1),L=et(["+","-"],!1,!1),F=et([["0","9"]],!1,!1),D=et([" ","\t","\r","\n"],!1,!1),E=function(t){return t},X=function(t,e){return t.concat(e)},k=function(t,e,n,i,r,o){return[{type:"matrix",a:t,b:e,c:n,d:i,e:r,f:o}]},B=function(t,e){var n={type:"translate",tx:t};return e&&(n.ty=e),[n]},O=function(t,e){var n={type:"scale",sx:t};return e&&(n.sy=e),[n]},U=function(t,e){var n={type:"rotate",angle:t};return e&&(n.cx=e[0],n.cy=e[1]),[n]},G=function(t){return[{type:"skewX",angle:t}]},j=function(t){return[{type:"skewY",angle:t}]},N=function(t){return parseFloat(t.join(""))},Y=function(t){return parseInt(t.join(""))},W=function(t){return t},V=function(t,e){return[t,e]},z=function(t){return t.join("")},q=function(t,e){return[t?t.join(""):null,".",e.join("")].join("")},H=function(t){return t.join("")},J=0,K=[{line:1,column:1}],Z=[],Q=0;if("startRule"in e){if(!(e.startRule in r))throw new Error("Can't start parsing from rule \""+e.startRule+'".');o=r[e.startRule]}function tt(t,e){return{type:"literal",text:t,ignoreCase:e}}function et(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function nt(t){return{type:"other",description:t}}function it(e){var n,i=K[e];if(i)return i;for(n=e-1;!K[n];)n--;for(i={line:(i=K[n]).line,column:i.column};n<e;)10===t.charCodeAt(n)?(i.line++,i.column=1):i.column++,n++;return K[e]=i,i}var rt="string"==typeof e.filename&&e.filename.length>0;function ot(t,n){var i={};rt&&(i.filename=e.filename);var r=it(t);i.start={offset:t,line:r.line,column:r.column};var o=it(n);return i.end={offset:n,line:o.line,column:o.column},i}function st(t){var e=Z[Z.length-1];J<e.pos||(J>e.pos&&(e.pos=J,e.variants=[]),e.variants.push(t))}function at(t,e,n){return new R(R.buildMessage(t,e),t,e,n)}function ct(){var t,e,n,r,o;for(t=J,e=[],n=yt();n!==i;)e.push(n),n=yt();for((n=function t(){var e,n,r,o;if(e=J,(n=lt())!==i){if(r=[],(o=dt())!==i)for(;o!==i;)r.push(o),o=dt();else r=i;r!==i&&(o=t())!==i?(e,e=X(n,o)):(J=e,e=i)}else J=e,e=i;e===i&&(e=lt());return e}())===i&&(n=null),r=[],o=yt();o!==i;)r.push(o),o=yt();return t,t=E(n)}function lt(){var e;return(e=function(){var e,n,r,o,l,h,u,d,f,p,g,v,m,y=function(t){0===Q&&st(t)};e=J,y(C),t.substr(J,6)===s?(n=s,J+=6):n=i;if(n!==i){for(r=[],o=yt();o!==i;)r.push(o),o=yt();if(y(b),40===t.charCodeAt(J)?(o=a,J++):o=i,o!==i){for(l=[],h=yt();h!==i;)l.push(h),h=yt();if((h=ht())!==i)if(dt()!==i)if((u=ht())!==i)if(dt()!==i)if((d=ht())!==i)if(dt()!==i)if((f=ht())!==i)if(dt()!==i)if((p=ht())!==i)if(dt()!==i)if((g=ht())!==i){for(v=[],m=yt();m!==i;)v.push(m),m=yt();y(S),41===t.charCodeAt(J)?(m=c,J++):m=i,m!==i?(e,e=k(h,u,d,f,p,g)):(J=e,e=i)}else J=e,e=i;else J=e,e=i;else J=e,e=i;else J=e,e=i;else J=e,e=i;else J=e,e=i;else J=e,e=i;else J=e,e=i;else J=e,e=i;else J=e,e=i;else J=e,e=i}else J=e,e=i}else J=e,e=i;return e}())===i&&(e=function(){var e,n,r,o,s,h,u,d,f,p=function(t){0===Q&&st(t)};e=J,p(w),t.substr(J,9)===l?(n=l,J+=9):n=i;if(n!==i){for(r=[],o=yt();o!==i;)r.push(o),o=yt();if(p(b),40===t.charCodeAt(J)?(o=a,J++):o=i,o!==i){for(s=[],h=yt();h!==i;)s.push(h),h=yt();if((h=ht())!==i){for((u=ut())===i&&(u=null),d=[],f=yt();f!==i;)d.push(f),f=yt();p(S),41===t.charCodeAt(J)?(f=c,J++):f=i,f!==i?(e,e=B(h,u)):(J=e,e=i)}else J=e,e=i}else J=e,e=i}else J=e,e=i;return e}())===i&&(e=function(){var e,n,r,o,s,l,u,d,f,p=function(t){0===Q&&st(t)};e=J,p(P),t.substr(J,5)===h?(n=h,J+=5):n=i;if(n!==i){for(r=[],o=yt();o!==i;)r.push(o),o=yt();if(p(b),40===t.charCodeAt(J)?(o=a,J++):o=i,o!==i){for(s=[],l=yt();l!==i;)s.push(l),l=yt();if((l=ht())!==i){for((u=ut())===i&&(u=null),d=[],f=yt();f!==i;)d.push(f),f=yt();p(S),41===t.charCodeAt(J)?(f=c,J++):f=i,f!==i?(e,e=O(l,u)):(J=e,e=i)}else J=e,e=i}else J=e,e=i}else J=e,e=i;return e}())===i&&(e=function(){var e,n,r,o,s,l,h,d,f,p=function(t){0===Q&&st(t)};e=J,p(M),t.substr(J,6)===u?(n=u,J+=6):n=i;if(n!==i){for(r=[],o=yt();o!==i;)r.push(o),o=yt();if(p(b),40===t.charCodeAt(J)?(o=a,J++):o=i,o!==i){for(s=[],l=yt();l!==i;)s.push(l),l=yt();if((l=ht())!==i){for((h=function(){var t,e,n;t=J,dt()!==i&&(e=ht())!==i&&dt()!==i&&(n=ht())!==i?(t,t=V(e,n)):(J=t,t=i);return t}())===i&&(h=null),d=[],f=yt();f!==i;)d.push(f),f=yt();p(S),41===t.charCodeAt(J)?(f=c,J++):f=i,f!==i?(e,e=U(l,h)):(J=e,e=i)}else J=e,e=i}else J=e,e=i}else J=e,e=i;return e}())===i&&(e=function(){var e,n,r,o,s,l,h,u,f=function(t){0===Q&&st(t)};e=J,f(A),t.substr(J,5)===d?(n=d,J+=5):n=i;if(n!==i){for(r=[],o=yt();o!==i;)r.push(o),o=yt();if(f(b),40===t.charCodeAt(J)?(o=a,J++):o=i,o!==i){for(s=[],l=yt();l!==i;)s.push(l),l=yt();if((l=ht())!==i){for(h=[],u=yt();u!==i;)h.push(u),u=yt();f(S),41===t.charCodeAt(J)?(u=c,J++):u=i,u!==i?(e,e=G(l)):(J=e,e=i)}else J=e,e=i}else J=e,e=i}else J=e,e=i;return e}())===i&&(e=function(){var e,n,r,o,s,l,h,u,d=function(t){0===Q&&st(t)};e=J,d(_),t.substr(J,5)===f?(n=f,J+=5):n=i;if(n!==i){for(r=[],o=yt();o!==i;)r.push(o),o=yt();if(d(b),40===t.charCodeAt(J)?(o=a,J++):o=i,o!==i){for(s=[],l=yt();l!==i;)s.push(l),l=yt();if((l=ht())!==i){for(h=[],u=yt();u!==i;)h.push(u),u=yt();d(S),41===t.charCodeAt(J)?(u=c,J++):u=i,u!==i?(e,e=j(l)):(J=e,e=i)}else J=e,e=i}else J=e,e=i}else J=e,e=i;return e}()),e}function ht(){var e,n,r,o;return e=J,n=J,(r=gt())===i&&(r=null),(o=function(){var e,n,r;e=J,(n=function(){var e,n,r,o;(function(t){0===Q&&st(t)})($),Q++,e=J,(n=vt())===i&&(n=null);46===t.charCodeAt(J)?(r=g,J++):r=i;r!==i&&(o=vt())!==i?(e,e=q(n,o)):(J=e,e=i);e===i&&(e=J,(n=vt())!==i?(46===t.charCodeAt(J)?(r=g,J++):r=i,r!==i?(e,e=H(n)):(J=e,e=i)):(J=e,e=i));return Q--,e}())!==i?((r=pt())===i&&(r=null),e=n=[n,r]):(J=e,e=i);e===i&&(e=J,(n=vt())!==i&&(r=pt())!==i?e=n=[n,r]:(J=e,e=i));return e}())!==i?n=r=[r,o]:(J=n,n=i),n!==i&&(e,n=N(n)),(e=n)===i&&(e=J,n=J,(r=gt())===i&&(r=null),(o=function(){var t,e;t=J,(e=vt())!==i&&(t,e=z(e));return t=e}())!==i?n=r=[r,o]:(J=n,n=i),n!==i&&(e,n=Y(n)),e=n),e}function ut(){var t,e;return t=J,dt()!==i&&(e=ht())!==i?(t,t=W(e)):(J=t,t=i),t}function dt(){var t,e,n,r,o;if(t=J,e=[],(n=yt())!==i)for(;n!==i;)e.push(n),n=yt();else e=i;if(e!==i){for((n=ft())===i&&(n=null),r=[],o=yt();o!==i;)r.push(o),o=yt();t=e=[e,n,r]}else J=t,t=i;if(t===i)if(t=J,(e=ft())!==i){for(n=[],r=yt();r!==i;)n.push(r),r=yt();t=e=[e,n]}else J=t,t=i;return t}function ft(){var e;return function(t){0===Q&&st(t)}(I),44===t.charCodeAt(J)?(e=p,J++):e=i,e}function pt(){var e,n,r,o;return e=J,function(t){0===Q&&st(t)}(T),v.test(t.charAt(J))?(n=t.charAt(J),J++):n=i,n!==i?((r=gt())===i&&(r=null),(o=vt())!==i?e=n=[n,r,o]:(J=e,e=i)):(J=e,e=i),e}function gt(){var e;return function(t){0===Q&&st(t)}(L),m.test(t.charAt(J))?(e=t.charAt(J),J++):e=i,e}function vt(){var t,e;if(t=[],(e=mt())!==i)for(;e!==i;)t.push(e),e=mt();else t=i;return t}function mt(){var e;return function(t){0===Q&&st(t)}(F),y.test(t.charAt(J))?(e=t.charAt(J),J++):e=i,e}function yt(){var e;return function(t){0===Q&&st(t)}(D),x.test(t.charAt(J))?(e=t.charAt(J),J++):e=i,e}if(Z.push({pos:J,variants:[]}),(n=o())!==i&&J===t.length)return n;throw n!==i&&J<t.length&&st({type:"end"}),function(){var e=Z[0],n=e.pos;return at(e.variants,n<t.length?t.charAt(n):null,n<t.length?ot(n,n+1):ot(n,n))}()}!function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(R,Error),R.buildMessage=function(t,e){var n={literal:function(t){return'"'+r(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?o(t[0])+"-"+o(t[1]):o(t)}));return"["+(t.inverted?"^":"")+e+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description},not:function(t){return"not "+s(t.expected)}};function i(t){return t.charCodeAt(0).toString(16).toUpperCase()}function r(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+i(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+i(t)}))}function o(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+i(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+i(t)}))}function s(t){return n[t.type](t)}return"Expected "+function(t){var e,n,i=t.map(s);if(i.sort(),i.length>0){for(e=1,n=1;e<i.length;e++)i[e-1]!==i[e]&&(i[n]=i[e],n++);i.length=n}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(t)+" but "+function(t){return t?'"'+r(t)+'"':"end of input"}(e)+" found."};function D(t){return F(t)}n.d(e,"applyToPoint",(function(){return i})),n.d(e,"applyToPoints",(function(){return r})),n.d(e,"fromObject",(function(){return o})),n.d(e,"fromString",(function(){return a})),n.d(e,"identity",(function(){return c})),n.d(e,"inverse",(function(){return l})),n.d(e,"isAffineMatrix",(function(){return d})),n.d(e,"rotate",(function(){return x})),n.d(e,"rotateDEG",(function(){return C})),n.d(e,"scale",(function(){return b})),n.d(e,"shear",(function(){return S})),n.d(e,"skew",(function(){return P})),n.d(e,"skewDEG",(function(){return M})),n.d(e,"toCSS",(function(){return A})),n.d(e,"toSVG",(function(){return _})),n.d(e,"toString",(function(){return I})),n.d(e,"transform",(function(){return p})),n.d(e,"compose",(function(){return g})),n.d(e,"translate",(function(){return f})),n.d(e,"fromTriangles",(function(){return T})),n.d(e,"smoothMatrix",(function(){return $})),n.d(e,"fromDefinition",(function(){return L})),n.d(e,"fromTransformAttribute",(function(){return D}))}])}));
//# sourceMappingURL=index.min.js.map