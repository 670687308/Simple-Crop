<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>PC</title>
  <link rel="stylesheet" href="../dist/template-1.css">
</head>

<body>
  <input id="upload" type="file" accept="image/png,image/jpeg">
  <button id="update">组件更新</button>

  <script src="../lib/prefix-umd.js"></script>
  <script src="../lib/exif.js"></script>
  <script src="../lib/transformation-matrix.js"></script>
  <script src="../index.js"></script>
  <script>
    window.onload = function () {
      var simpleCrop = new SimpleCrop({
        title: '上传图片过大，请裁剪',
        src: '../img/test2.jpg',
        size: {
          width: 800,
          height: 600
        },
        cropSizePercent: 0.65,
        scaleSlider: true,
        maxScale: 3,
        borderWidth: 1,
        funcBtns: ['close', 'crop', 'upload'],
        borderColor: "#fff",
        coverColor: 'rgba(0,0,0,.5)',
        startAngle: -360,
        endAngle: 360,
        cropCallback: function ($resultCanvas) {
          $resultCanvas.style.marginRight = '10px';
          $resultCanvas.style.width = '50%';
          document.body.appendChild($resultCanvas);
        },
      });

      //选取裁剪图片
      var $upload = document.querySelector('#upload');
      $upload.addEventListener('change', function (evt) {
        var files = evt.target.files;
        if (files.length > 0) {
          simpleCrop.show(files[0]);
        }
        $upload.value = ''; //清空value属性，从而保证用户修改文件内容但是没有修改文件名时依然能上传成功
      });

      //组件更新
      var $update = document.querySelector('#update');
      $update.addEventListener('click', function () {
        simpleCrop.updateBox({
          cropSizePercent: 0.7,
          size: {
            width: 800,
            height: 800,
          }
        });
        simpleCrop.initBoxBorder({
          borderColor: "#0BFF00",
        });
        simpleCrop.show();
      });
    }
  </script>
</body>

</html>